# DSL脚本范例说明

本项目提供了多个不同的DSL脚本范例，展示不同业务场景下的客服机器人应答逻辑。每个脚本执行后会有不同的行为表现。

## 脚本列表

### 基础场景脚本（3个）

### 1. `order_query.dsl` - 订单查询场景
**业务场景**：专注于订单查询功能
**特点**：
- 单一业务场景，简洁明了
- 只包含订单查询意图
- 适合展示基础功能

**使用示例**：
```bash
python src/cli.py scripts/order_query.dsl
```

**行为表现**：
- 用户输入"查询订单" → 询问订单号 → 返回订单状态

---

### 2. `refund.dsl` - 退款申请场景
**业务场景**：专注于退款申请功能
**特点**：
- 单一业务场景，流程完整
- 包含退款原因选择（选项功能）
- 展示多步骤交互流程

**使用示例**：
```bash
python src/cli.py scripts/refund.dsl
```

**行为表现**：
- 用户输入"退款" → 选择退款原因 → 输入订单号 → 返回退款申请号

---

### 3. `tech_support.dsl` - 技术支持场景
**业务场景**：专注于技术支持功能
**特点**：
- 单一业务场景，问题处理
- 包含问题描述收集
- 展示工单创建流程

**使用示例**：
```bash
python src/cli.py scripts/tech_support.dsl
```

**行为表现**：
- 用户输入"技术支持" → 描述问题 → 创建工单 → 返回工单号

---

### 4. `combined.dsl` - 综合场景（基础版）
**业务场景**：包含多个基础业务场景
**特点**：
- 多业务场景整合
- 包含订单查询、退款申请、技术支持三个场景
- 展示DSL脚本的多意图支持能力

**使用示例**：
```bash
python src/cli.py scripts/combined.dsl
```

**行为表现**：
- 支持"查询订单"、"退款"、"技术支持"等多种意图
- 根据用户输入自动识别意图并执行相应流程

---

### 5. `enhanced.dsl` - 增强版综合场景

---

### 高级场景脚本（5个新脚本）

### 6. `shopping_assistant.dsl` - 智能购物助手
**业务场景**：个性化推荐、库存查询、运费计算、促销活动、购物车管理
**特点**：
- 支持个性化商品推荐（基于用户偏好）
- 实时库存查询
- 智能运费计算（根据地址和重量）
- 促销活动查询
- 购物车管理
- 订单跟踪

**使用示例**：
```bash
python src/cli.py scripts/shopping_assistant.dsl
```

**行为表现**：
- 用户输入"推荐" → 个性化推荐流程
- 用户输入"库存" → 库存查询
- 用户输入"运费" → 运费计算
- 展示智能购物助手的完整功能

---

### 7. `member_service.dsl` - 会员服务中心
**业务场景**：会员信息、权益查询、积分系统、会员升级、生日特权
**特点**：
- 完整的会员等级体系
- 积分查询和兑换
- 会员升级规则
- 生日特权活动
- 会员专享优惠

**使用示例**：
```bash
python src/cli.py scripts/member_service.dsl
```

**行为表现**：
- 用户输入"会员" → 会员信息查询
- 用户输入"积分" → 积分查询和兑换
- 用户输入"升级" → 会员升级规则
- 展示完整的会员服务体系

---

### 8. `after_sales.dsl` - 售后服务中心
**业务场景**：换货、维修、退货、质保查询、售后政策
**特点**：
- 完整的售后流程（换货、维修、退货）
- 售后进度查询
- 质保信息查询
- 售后政策说明
- 多步骤交互流程

**使用示例**：
```bash
python src/cli.py scripts/after_sales.dsl
```

**行为表现**：
- 用户输入"售后" → 售后服务咨询
- 用户输入"换货" → 换货申请流程
- 用户输入"维修" → 维修申请流程
- 展示完整的售后服务体系

---

### 9. `marketing_center.dsl` - 营销活动中心
**业务场景**：限时活动、节日促销、优惠券、满减活动、新品发布
**特点**：
- 多种营销活动类型
- 限时活动管理
- 节日促销活动
- 优惠券领取和使用
- 满减活动规则

**使用示例**：
```bash
python src/cli.py scripts/marketing_center.dsl
```

**行为表现**：
- 用户输入"活动" → 活动查询
- 用户输入"限时" → 限时活动详情
- 用户输入"优惠券" → 优惠券领取
- 展示完整的营销活动体系

---

### 10. `premium_service.dsl` - 高端定制服务
**业务场景**：定制服务、个性化推荐、VIP服务、礼品定制、企业团购
**特点**：
- 高端定制服务
- 高级个性化推荐
- VIP专属服务
- 礼品定制服务
- 企业团购服务
- 预约服务

**使用示例**：
```bash
python src/cli.py scripts/premium_service.dsl
```

**行为表现**：
- 用户输入"定制" → 定制服务咨询
- 用户输入"VIP" → VIP专属服务
- 用户输入"礼品" → 礼品定制流程
- 展示高端服务的完整体系

---

## 脚本对比
```

**行为表现**：
- 支持多个业务场景的意图识别
- 支持追问和话题发散
- 回复内容多样化（使用随机函数）
- 自动提供追问选项，引导深入对话

---

## 脚本对比

| 脚本 | 业务场景数 | 意图数 | 特色功能 | 适用场景 |
|------|-----------|--------|---------|---------|
| `order_query.dsl` | 1 | 1 | 基础查询 | 演示单一功能 |
| `refund.dsl` | 1 | 1 | 选项选择 | 演示多步骤流程 |
| `tech_support.dsl` | 1 | 1 | 工单创建 | 演示问题处理 |
| `combined.dsl` | 3 | 3 | 多场景整合 | 演示多意图识别 |
| `enhanced.dsl` | 10+ | 15+ | 深度对话、上下文 | 演示完整系统 |
| `shopping_assistant.dsl` | 7 | 7 | 个性化推荐、库存、运费 | 演示智能购物 |
| `member_service.dsl` | 7 | 7 | 会员体系、积分系统 | 演示会员服务 |
| `after_sales.dsl` | 7 | 7 | 完整售后流程 | 演示售后服务 |
| `marketing_center.dsl` | 8 | 8 | 营销活动、促销 | 演示营销功能 |
| `premium_service.dsl` | 7 | 7 | 定制服务、VIP | 演示高端服务 |

## 技术要点

### 大模型使用
- **用途**：仅用于意图识别（识别用户输入匹配哪个意图）
- **位置**：`src/llm_client.py` 中的 `identify_intent()` 方法
- **不用于**：生成回复内容（回复内容由DSL脚本定义）

### DSL脚本定义回复
- 所有回复内容都在DSL脚本的 `response` 语句中定义
- 可以使用函数调用和变量来生成动态回复
- 支持模板字符串，可以嵌入变量和函数调用结果

### 不同脚本的不同行为
- **单一场景脚本**（如 `order_query.dsl`）：只响应特定意图，行为简单直接
- **综合场景脚本**（如 `combined.dsl`）：支持多个意图，根据用户输入自动识别
- **增强版脚本**（如 `enhanced.dsl`）：支持深度对话，有追问机制和话题发散

## 演示建议

### 基础演示
1. 运行 `order_query.dsl` - 展示单一场景
2. 运行 `refund.dsl` - 展示多步骤流程
3. 运行 `combined.dsl` - 展示多场景整合

### 完整演示
1. 运行 `enhanced.dsl` - 展示完整功能
2. 测试不同业务场景的意图识别
3. 测试追问机制和话题发散
4. 展示对话历史和上下文管理

## 注意事项

- 所有脚本都需要配置 `ZHIPUAI_API_KEY` 环境变量
- 大模型仅用于意图识别，不用于生成回复
- 不同脚本执行后会有明显不同的行为表现
- 增强版脚本展示了DSL脚本的完整表达能力

